local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")

local player = Players.LocalPlayer
local mouse = player:GetMouse()

-- Настройки
local settings = {
    speed = 1,
    isFlying = false,
    isNoClip = false,
    isESPEnabled = false,
    isSpeedHack = false,
    isAimbot = false,
    isBhop = false,
    isAntiAFK = false,
    isFullbright = false,
    espNames = true,
    espDistance = true,
    espBoxes = true,
    speedHackValue = 2,
    bhopSpeed = 1.5,
    
    -- Бинды
    keybinds = {
        fly = Enum.KeyCode.F,
        noclip = Enum.KeyCode.V,
        esp = Enum.KeyCode.X,
        aimbot = Enum.KeyCode.Q,
        bhop = Enum.KeyCode.Space,
        speedhack = Enum.KeyCode.LeftShift
    }
}

-- Создание GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "Script"
screenGui.Parent = CoreGui
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Главный фрейм
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Parent = screenGui
mainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
mainFrame.BorderSizePixel = 0
mainFrame.Position = UDim2.new(0.1, 0, 0.2, 0)
mainFrame.Size = UDim2.new(0, 300, 0, 400)
mainFrame.Active = true
mainFrame.Draggable = true

-- Заголовок
local titleFrame = Instance.new("Frame")
titleFrame.Name = "TitleFrame"
titleFrame.Parent = mainFrame
titleFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
titleFrame.BorderSizePixel = 0
titleFrame.Size = UDim2.new(1, 0, 0, 30)

local titleLabel = Instance.new("TextLabel")
titleLabel.Name = "TitleLabel"
titleLabel.Parent = titleFrame
titleLabel.BackgroundTransparency = 1
titleLabel.Size = UDim2.new(1, -60, 1, 0)
titleLabel.Font = Enum.Font.SourceSansBold
titleLabel.Text = "SCRIPT"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.TextSize = 16

-- Кнопки управления
local closeButton = Instance.new("TextButton")
closeButton.Name = "CloseButton"
closeButton.Parent = titleFrame
closeButton.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
closeButton.BorderSizePixel = 0
closeButton.Position = UDim2.new(1, -30, 0, 5)
closeButton.Size = UDim2.new(0, 25, 0, 20)
closeButton.Font = Enum.Font.SourceSansBold
closeButton.Text = "X"
closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
closeButton.TextSize = 12

-- Фрейм для вкладок
local tabsFrame = Instance.new("Frame")
tabsFrame.Name = "TabsFrame"
tabsFrame.Parent = mainFrame
tabsFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
tabsFrame.BorderSizePixel = 0
tabsFrame.Position = UDim2.new(0, 0, 0, 30)
tabsFrame.Size = UDim2.new(1, 0, 0, 30)

-- Фрейм для контента
local contentFrame = Instance.new("Frame")
contentFrame.Name = "ContentFrame"
contentFrame.Parent = mainFrame
contentFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
contentFrame.BorderSizePixel = 0
contentFrame.Position = UDim2.new(0, 0, 0, 60)
contentFrame.Size = UDim2.new(1, 0, 1, -60)

-- Создаем вкладки
local tabs = {"Movement", "Visuals", "Combat", "Utility"}

local tabButtons = {}
local tabContents = {}

for i, tabName in ipairs(tabs) do
    -- Кнопка вкладки
    local tabButton = Instance.new("TextButton")
    tabButton.Name = tabName .. "Tab"
    tabButton.Parent = tabsFrame
    tabButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    tabButton.BorderSizePixel = 0
    tabButton.Position = UDim2.new((i-1) / #tabs, 0, 0, 0)
    tabButton.Size = UDim2.new(1 / #tabs, 0, 1, 0)
    tabButton.Font = Enum.Font.SourceSans
    tabButton.Text = tabName
    tabButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    tabButton.TextSize = 12
    
    -- Контент вкладки
    local tabContent = Instance.new("ScrollingFrame")
    tabContent.Name = tabName .. "Content"
    tabContent.Parent = contentFrame
    tabContent.BackgroundTransparency = 1
    tabContent.Size = UDim2.new(1, 0, 1, 0)
    tabContent.Visible = false
    tabContent.ScrollingEnabled = true
    tabContent.ScrollBarThickness = 0
    
    tabButtons[tabName] = tabButton
    tabContents[tabName] = tabContent
    
    tabButton.MouseButton1Click:Connect(function()
        switchTab(tabName)
    end)
end

-- Функция переключения вкладок
function switchTab(tabName)
    for name, content in pairs(tabContents) do
        content.Visible = false
    end
    
    for name, button in pairs(tabButtons) do
        button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    end
    
    if tabContents[tabName] then
        tabContents[tabName].Visible = true
    end
    if tabButtons[tabName] then
        tabButtons[tabName].BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    end
end

-- Функция для создания переключателя
function createToggle(parent, text, defaultValue, callback)
    local toggleFrame = Instance.new("Frame")
    toggleFrame.Parent = parent
    toggleFrame.BackgroundTransparency = 1
    toggleFrame.Size = UDim2.new(1, -10, 0, 30)
    
    local label = Instance.new("TextLabel")
    label.Parent = toggleFrame
    label.BackgroundTransparency = 1
    label.Size = UDim2.new(0.7, 0, 1, 0)
    label.Font = Enum.Font.SourceSans
    label.Text = text
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.TextSize = 14
    label.TextXAlignment = Enum.TextXAlignment.Left
    
    local toggleButton = Instance.new("TextButton")
    toggleButton.Parent = toggleFrame
    toggleButton.BackgroundColor3 = defaultValue and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
    toggleButton.BorderSizePixel = 0
    toggleButton.Position = UDim2.new(0.7, 0, 0.2, 0)
    toggleButton.Size = UDim2.new(0.25, 0, 0.6, 0)
    toggleButton.Font = Enum.Font.SourceSans
    toggleButton.Text = defaultValue and "ON" or "OFF"
    toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    toggleButton.TextSize = 12
    
    toggleButton.MouseButton1Click:Connect(function()
        local newValue = not defaultValue
        toggleButton.BackgroundColor3 = newValue and Color3.fromRGB(0, 255, 0) or Color3.fromRGB(255, 0, 0)
        toggleButton.Text = newValue and "ON" or "OFF"
        defaultValue = newValue
        callback(newValue)
    end)
    
    return {frame = toggleFrame, button = toggleButton, value = defaultValue}
end

-- Функция для создания слайдера
function createSlider(parent, text, minValue, maxValue, currentValue, callback)
    local sliderFrame = Instance.new("Frame")
    sliderFrame.Parent = parent
    sliderFrame.BackgroundTransparency = 1
    sliderFrame.Size = UDim2.new(1, -10, 0, 50)
    
    local label = Instance.new("TextLabel")
    label.Parent = sliderFrame
    label.BackgroundTransparency = 1
    label.Size = UDim2.new(1, 0, 0, 20)
    label.Font = Enum.Font.SourceSans
    label.Text = text .. ": " .. currentValue
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.TextSize = 14
    
    local track = Instance.new("Frame")
    track.Parent = sliderFrame
    track.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    track.BorderSizePixel = 0
    track.Position = UDim2.new(0, 0, 0, 25)
    track.Size = UDim2.new(1, 0, 0, 10)
    
    local fill = Instance.new("Frame")
    fill.Parent = track
    fill.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
    fill.BorderSizePixel = 0
    fill.Size = UDim2.new((currentValue - minValue) / (maxValue - minValue), 0, 1, 0)
    
    local button = Instance.new("TextButton")
    button.Parent = track
    button.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    button.BorderSizePixel = 0
    button.Size = UDim2.new(0, 15, 0, 15)
    button.Position = UDim2.new((currentValue - minValue) / (maxValue - minValue), -7, 0, -2)
    button.Text = ""
    
    local dragging = false
    
    button.MouseButton1Down:Connect(function()
        dragging = true
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local mousePos = UserInputService:GetMouseLocation()
            local trackPos = track.AbsolutePosition
            local trackSize = track.AbsoluteSize
            
            local relativeX = math.clamp((mousePos.X - trackPos.X) / trackSize.X, 0, 1)
            local value = math.floor((minValue + (maxValue - minValue) * relativeX) * 10) / 10
            
            fill.Size = UDim2.new(relativeX, 0, 1, 0)
            button.Position = UDim2.new(relativeX, -7, 0, -2)
            label.Text = text .. ": " .. value
            
            callback(value)
        end
    end)
    
    return sliderFrame
end

-- Заполняем вкладки контентом

-- Вкладка Movement
local movementContent = tabContents.Movement
movementContent.CanvasSize = UDim2.new(0, 0, 0, 400)

local flyToggle = createToggle(movementContent, "Flight", settings.isFlying, function(value)
    settings.isFlying = value
    if value then
        enableFlight()
    else
        disableFlight()
    end
end)
flyToggle.frame.Position = UDim2.new(0, 5, 0, 10)

local noclipToggle = createToggle(movementContent, "NoClip", settings.isNoClip, function(value)
    settings.isNoClip = value
    if value then
        enableNoClip()
    else
        disableNoClip()
    end
end)
noclipToggle.frame.Position = UDim2.new(0, 5, 0, 50)

local speedToggle = createToggle(movementContent, "Speed Hack", settings.isSpeedHack, function(value)
    settings.isSpeedHack = value
    if value then
        enableSpeedHack()
    else
        disableSpeedHack()
    end
end)
speedToggle.frame.Position = UDim2.new(0, 5, 0, 90)

local bhopToggle = createToggle(movementContent, "Bunny Hop", settings.isBhop, function(value)
    settings.isBhop = value
    if value then
        enableBhop()
    else
        disableBhop()
    end
end)
bhopToggle.frame.Position = UDim2.new(0, 5, 0, 130)

local flySpeedSlider = createSlider(movementContent, "Flight Speed", 1, 10, settings.speed, function(value)
    settings.speed = value
end)
flySpeedSlider.Position = UDim2.new(0, 5, 0, 170)

local speedSlider = createSlider(movementContent, "Speed Multiplier", 1, 5, settings.speedHackValue, function(value)
    settings.speedHackValue = value
    if settings.isSpeedHack then
        disableSpeedHack()
        enableSpeedHack()
    end
end)
speedSlider.Position = UDim2.new(0, 5, 0, 230)

local bhopSlider = createSlider(movementContent, "Bhop Power", 1, 3, settings.bhopSpeed, function(value)
    settings.bhopSpeed = value
end)
bhopSlider.Position = UDim2.new(0, 5, 0, 290)

-- Вкладка Visuals
local visualsContent = tabContents.Visuals
visualsContent.CanvasSize = UDim2.new(0, 0, 0, 300)

local espToggle = createToggle(visualsContent, "Player ESP", settings.isESPEnabled, function(value)
    settings.isESPEnabled = value
    if value then
        enableESP()
    else
        disableESP()
    end
end)
espToggle.frame.Position = UDim2.new(0, 5, 0, 10)

local espNamesToggle = createToggle(visualsContent, "Show Names", settings.espNames, function(value)
    settings.espNames = value
    updateESP()
end)
espNamesToggle.frame.Position = UDim2.new(0, 5, 0, 50)

local espDistanceToggle = createToggle(visualsContent, "Show Distance", settings.espDistance, function(value)
    settings.espDistance = value
    updateESP()
end)
espDistanceToggle.frame.Position = UDim2.new(0, 5, 0, 90)

local espBoxesToggle = createToggle(visualsContent, "Show Boxes", settings.espBoxes, function(value)
    settings.espBoxes = value
    updateESP()
end)
espBoxesToggle.frame.Position = UDim2.new(0, 5, 0, 130)

local fullbrightToggle = createToggle(visualsContent, "Fullbright", settings.isFullbright, function(value)
    settings.isFullbright = value
    if value then
        enableFullbright()
    else
        disableFullbright()
    end
end)
fullbrightToggle.frame.Position = UDim2.new(0, 5, 0, 170)

-- Вкладка Combat
local combatContent = tabContents.Combat
combatContent.CanvasSize = UDim2.new(0, 0, 0, 100)

local aimbotToggle = createToggle(combatContent, "Aimbot", settings.isAimbot, function(value)
    settings.isAimbot = value
    if value then
        enableAimbot()
    else
        disableAimbot()
    end
end)
aimbotToggle.frame.Position = UDim2.new(0, 5, 0, 10)

local aimbotKeyLabel = Instance.new("TextLabel")
aimbotKeyLabel.Parent = combatContent
aimbotKeyLabel.BackgroundTransparency = 1
aimbotKeyLabel.Position = UDim2.new(0, 5, 0, 50)
aimbotKeyLabel.Size = UDim2.new(1, -10, 0, 20)
aimbotKeyLabel.Font = Enum.Font.SourceSans
aimbotKeyLabel.Text = "Aimbot Key: " .. settings.keybinds.aimbot.Name
aimbotKeyLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
aimbotKeyLabel.TextSize = 12

-- Вкладка Utility
local utilityContent = tabContents.Utility
utilityContent.CanvasSize = UDim2.new(0, 0, 0, 100)

local antiAFKToggle = createToggle(utilityContent, "Anti-AFK", settings.isAntiAFK, function(value)
    settings.isAntiAFK = value
    if value then
        enableAntiAFK()
    else
        disableAntiAFK()
    end
end)
antiAFKToggle.frame.Position = UDim2.new(0, 5, 0, 10)

local keybindsLabel = Instance.new("TextLabel")
keybindsLabel.Parent = utilityContent
keybindsLabel.BackgroundTransparency = 1
keybindsLabel.Position = UDim2.new(0, 5, 0, 50)
keybindsLabel.Size = UDim2.new(1, -10, 0, 40)
keybindsLabel.Font = Enum.Font.SourceSans
keybindsLabel.Text = "Keybinds:\nF-Flight V-NoClip\nX-ESP Q-Aimbot\nSpace-Bhop Shift-Speed"
keybindsLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
keybindsLabel.TextSize = 12
keybindsLabel.TextWrapped = true

-- СИСТЕМЫ ФУНКЦИЙ

-- Flight System
function enableFlight()
    if settings.isFlying then return end
    
    local character = player.Character
    if not character then return end
    
    local humanoid = character:FindFirstChildWhichIsA("Humanoid")
    if not humanoid then return end
    
    settings.isFlying = true
    
    -- Простая система полета
    local bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.Velocity = Vector3.new(0, 0, 0)
    bodyVelocity.MaxForce = Vector3.new(4000, 4000, 4000)
    bodyVelocity.Parent = character.HumanoidRootPart
    
    local flightConnection
    flightConnection = RunService.Heartbeat:Connect(function()
        if not settings.isFlying or not character then
            flightConnection:Disconnect()
            return
        end
        
        local cam = workspace.CurrentCamera
        local moveDirection = Vector3.new(0, 0, 0)
        
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then
            moveDirection = moveDirection + cam.CFrame.LookVector
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then
            moveDirection = moveDirection - cam.CFrame.LookVector
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then
            moveDirection = moveDirection - cam.CFrame.RightVector
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then
            moveDirection = moveDirection + cam.CFrame.RightVector
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
            moveDirection = moveDirection + Vector3.new(0, 1, 0)
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then
            moveDirection = moveDirection - Vector3.new(0, 1, 0)
        end
        
        bodyVelocity.Velocity = moveDirection * (settings.speed * 50)
    end)
end

function disableFlight()
    if not settings.isFlying then return end
    settings.isFlying = false
    
    local character = player.Character
    if character and character.HumanoidRootPart then
        for _, v in pairs(character.HumanoidRootPart:GetChildren()) do
            if v:IsA("BodyVelocity") then
                v:Destroy()
            end
        end
    end
end

-- NoClip System
function enableNoClip()
    if settings.isNoClip then return end
    settings.isNoClip = true
    
    local character = player.Character
    if not character then return end
    
    RunService.Stepped:Connect(function()
        if not settings.isNoClip or not character then return end
        
        for _, part in pairs(character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end)
end

function disableNoClip()
    if not settings.isNoClip then return end
    settings.isNoClip = false
end

-- Speed Hack System
function enableSpeedHack()
    if settings.isSpeedHack then return end
    settings.isSpeedHack = true
    
    local character = player.Character
    if not character then return end
    
    local humanoid = character:FindFirstChildWhichIsA("Humanoid")
    if humanoid then
        humanoid.WalkSpeed = humanoid.WalkSpeed * settings.speedHackValue
    end
end

function disableSpeedHack()
    if not settings.isSpeedHack then return end
    settings.isSpeedHack = false
    
    local character = player.Character
    if not character then return end
    
    local humanoid = character:FindFirstChildWhichIsA("Humanoid")
    if humanoid then
        humanoid.WalkSpeed = humanoid.WalkSpeed / settings.speedHackValue
    end
end

-- Bunny Hop System
function enableBhop()
    if settings.isBhop then return end
    settings.isBhop = true
    
    local bhopConnection
    bhopConnection = RunService.Heartbeat:Connect(function()
        if not settings.isBhop or not player.Character then return end
        
        local humanoid = player.Character:FindFirstChildWhichIsA("Humanoid")
        if humanoid and humanoid.FloorMaterial ~= Enum.Material.Air then
            humanoid.Jump = true
        end
    end)
end

function disableBhop()
    if not settings.isBhop then return end
    settings.isBhop = false
end

-- ESP System
local espHighlights = {}

function enableESP()
    if settings.isESPEnabled then return end
    settings.isESPEnabled = true
    
    for _, otherPlayer in pairs(Players:GetPlayers()) do
        if otherPlayer ~= player then
            createESP(otherPlayer)
        end
    end
end

function disableESP()
    if not settings.isESPEnabled then return end
    settings.isESPEnabled = false
    
    for _, espData in pairs(espHighlights) do
        if espData then
            if espData.highlight then espData.highlight:Destroy() end
            if espData.billboard then espData.billboard:Destroy() end
        end
    end
    espHighlights = {}
end

function updateESP()
    for player, espData in pairs(espHighlights) do
        if espData and espData.billboard then
            local nameLabel = espData.billboard:FindFirstChild("NameLabel")
            local distanceLabel = espData.billboard:FindFirstChild("DistanceLabel")
            
            if nameLabel then nameLabel.Visible = settings.espNames end
            if distanceLabel then distanceLabel.Visible = settings.espDistance end
            if espData.highlight then espData.highlight.Enabled = settings.espBoxes end
        end
    end
end

function createESP(targetPlayer)
    if not targetPlayer or not targetPlayer.Character then return end
    
    local character = targetPlayer.Character
    local humanoid = character:FindFirstChildWhichIsA("Humanoid")
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    
    if not humanoid or not rootPart then return end
    
    -- Highlight
    local highlight = Instance.new("Highlight")
    highlight.Name = "ESP_Highlight"
    highlight.Parent = character
    highlight.Adornee = character
    highlight.FillColor = targetPlayer.Team and targetPlayer.TeamColor.Color or Color3.fromRGB(255, 0, 0)
    highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
    highlight.FillTransparency = 0.7
    highlight.OutlineTransparency = 0
    highlight.Enabled = settings.espBoxes
    
    -- Name Tag
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "ESP_Billboard"
    billboard.Parent = character
    billboard.Adornee = rootPart
    billboard.Size = UDim2.new(0, 200, 0, 50)
    billboard.StudsOffset = Vector3.new(0, 3, 0)
    billboard.AlwaysOnTop = true
    
    local nameLabel = Instance.new("TextLabel")
    nameLabel.Name = "NameLabel"
    nameLabel.Parent = billboard
    nameLabel.BackgroundTransparency = 1
    nameLabel.Size = UDim2.new(1, 0, 0.5, 0)
    nameLabel.Font = Enum.Font.SourceSansBold
    nameLabel.Text = targetPlayer.Name
    nameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    nameLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    nameLabel.TextStrokeTransparency = 0
    nameLabel.TextSize = 14
    nameLabel.Visible = settings.espNames
    
    local distanceLabel = Instance.new("TextLabel")
    distanceLabel.Name = "DistanceLabel"
    distanceLabel.Parent = billboard
    distanceLabel.BackgroundTransparency = 1
    distanceLabel.Size = UDim2.new(1, 0, 0.5, 0)
    distanceLabel.Position = UDim2.new(0, 0, 0.5, 0)
    distanceLabel.Font = Enum.Font.SourceSans
    distanceLabel.TextColor3 = Color3.fromRGB(200, 200, 200)
    distanceLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    distanceLabel.TextStrokeTransparency = 0
    distanceLabel.TextSize = 12
    distanceLabel.Visible = settings.espDistance
    
    -- Update distance
    RunService.Heartbeat:Connect(function()
        if not settings.isESPEnabled or not character or not player.Character then
            return
        end
        
        local playerRoot = player.Character:FindFirstChild("HumanoidRootPart")
        if playerRoot and rootPart then
            local distance = (playerRoot.Position - rootPart.Position).Magnitude
            distanceLabel.Text = math.floor(distance) .. " studs"
        end
    end)
    
    espHighlights[targetPlayer] = {
        highlight = highlight,
        billboard = billboard
    }
end

-- Aimbot System
function enableAimbot()
    if settings.isAimbot then return end
    settings.isAimbot = true
end

function disableAimbot()
    if not settings.isAimbot then return end
    settings.isAimbot = false
end

-- Anti-AFK System
function enableAntiAFK()
    if settings.isAntiAFK then return end
    settings.isAntiAFK = true
    
    local virtualUser = game:GetService("VirtualUser")
    game:GetService("Players").LocalPlayer.Idled:connect(function()
        virtualUser:CaptureController()
        virtualUser:ClickButton2(Vector2.new())
    end)
end

function disableAntiAFK()
    if not settings.isAntiAFK then return end
    settings.isAntiAFK = false
end

-- Fullbright System
function enableFullbright()
    if settings.isFullbright then return end
    settings.isFullbright = true
    
    game:GetService("Lighting").Ambient = Color3.new(1, 1, 1)
    game:GetService("Lighting").Brightness = 2
    game:GetService("Lighting").GlobalShadows = false
end

function disableFullbright()
    if not settings.isFullbright then return end
    settings.isFullbright = false
    
    game:GetService("Lighting").Ambient = Color3.new(0, 0, 0)
    game:GetService("Lighting").Brightness = 1
    game:GetService("Lighting").GlobalShadows = true
end

-- Keybind System
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode.Insert then
        screenGui.Enabled = not screenGui.Enabled
    elseif input.KeyCode == Enum.KeyCode.Delete then
        -- Panic button
        disableFlight()
        disableNoClip()
        disableSpeedHack()
        disableBhop()
        disableESP()
        disableAimbot()
        disableAntiAFK()
        disableFullbright()
    elseif input.KeyCode == Enum.KeyCode.End then
        screenGui:Destroy()
        return
    end
    
    -- Custom Keybinds
    if input.KeyCode == settings.keybinds.fly then
        settings.isFlying = not settings.isFlying
        if settings.isFlying then
            enableFlight()
        else
            disableFlight()
        end
    elseif input.KeyCode == settings.keybinds.noclip then
        settings.isNoClip = not settings.isNoClip
        if settings.isNoClip then
            enableNoClip()
        else
            disableNoClip()
        end
    elseif input.KeyCode == settings.keybinds.esp then
        settings.isESPEnabled = not settings.isESPEnabled
        if settings.isESPEnabled then
            enableESP()
        else
            disableESP()
        end
    elseif input.KeyCode == settings.keybinds.aimbot then
        -- Aimbot logic here
    elseif input.KeyCode == settings.keybinds.bhop then
        settings.isBhop = not settings.isBhop
        if settings.isBhop then
            enableBhop()
        else
            disableBhop()
        end
    elseif input.KeyCode == settings.keybinds.speedhack then
        settings.isSpeedHack = not settings.isSpeedHack
        if settings.isSpeedHack then
            enableSpeedHack()
        else
            disableSpeedHack()
        end
    end
end)

-- Обработчики кнопок
closeButton.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

-- Автоматическая очистка
player.CharacterAdded:Connect(function(character)
    wait(1)
    disableFlight()
    disableNoClip()
end)

-- Инициализация
switchTab("Movement")

-- Уведомление
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "SCRIPT LOADED",
    Text = "Insert - GUI, Delete - Panic, End - Unload",
    Duration = 5
})

print("Script loaded successfully!")
print("All functions are available in the menu!")
