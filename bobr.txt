-- Complete Cheat Menu with Configs, Aimbot, ESP, Wallshoot
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local CoreGui = game:GetService("CoreGui")
local TweenService = game:GetService("TweenService")
local Workspace = game:GetService("Workspace")
local HttpService = game:GetService("HttpService")

local player = Players.LocalPlayer

print("=== ULTIMATE CHEAT MENU ===")

-- ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ
local Config = {
    Speed = {
        Enabled = false,
        Value = 50
    },
    Jump = {
        Enabled = false,
        Value = 100
    },
    Noclip = {
        Enabled = false
    },
    Fly = {
        Enabled = false,
        Speed = 50
    },
    ESP = {
        Enabled = false,
        EnemyColor = Color3.new(1, 0, 0),
        TeamColor = Color3.new(0, 0, 1),
        NeutralColor = Color3.new(0, 1, 0),
        Transparency = 0.5
    },
    Aimbot = {
        Enabled = false,
        FOV = 100,
        Smoothness = 0.8,
        Target = "Head", -- Head, Torso, HumanoidRootPart
        IgnoreTeam = true,
        IgnoreSelf = true
    },
    Wallshoot = {
        Enabled = false,
        IgnoreWalls = true,
        IgnoreMap = true
    },
    FOV = {
        Enabled = false,
        Value = 120
    },
    Menu = {
        Keybind = Enum.KeyCode.Insert,
        DestroyKey = Enum.KeyCode.Delete,
        ManualAimKey = Enum.KeyCode.F,
        FOVResetKey = Enum.KeyCode.F5
    }
}

-- Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³Ð¾Ð²
local function saveConfig()
    local data = HttpService:JSONEncode(Config)
    writefile("ultimate_cheat_config.json", data)
    print("ðŸ’¾ Config saved!")
end

-- Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° ÐºÐ¾Ð½Ñ„Ð¸Ð³Ð¾Ð²
local function loadConfig()
    if isfile("ultimate_cheat_config.json") then
        local success, data = pcall(function()
            return HttpService:JSONDecode(readfile("ultimate_cheat_config.json"))
        end)
        if success then
            Config = data
            print("ðŸ“ Config loaded!")
        end
    end
end

-- Ð—Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ ÐºÐ¾Ð½Ñ„Ð¸Ð³ Ð¿Ñ€Ð¸ ÑÑ‚Ð°Ñ€Ñ‚Ðµ
loadConfig()

-- Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÐºÑ€Ð°ÑÐ¸Ð²Ð¾Ðµ Ð¼ÐµÐ½ÑŽ
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "UltimateCheatMenu"
screenGui.Parent = CoreGui

-- ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ñ„Ñ€ÐµÐ¹Ð¼
local mainFrame = Instance.new("Frame")
mainFrame.Name = "MainFrame"
mainFrame.Parent = screenGui
mainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
mainFrame.BorderSizePixel = 0
mainFrame.Position = UDim2.new(0.1, 0, 0.15, 0)
mainFrame.Size = UDim2.new(0, 350, 0, 500)
mainFrame.Active = true
mainFrame.Draggable = true

-- Ð¢ÐµÐ½ÑŒ
local shadow = Instance.new("ImageLabel")
shadow.Name = "Shadow"
shadow.Parent = mainFrame
shadow.BackgroundTransparency = 1
shadow.Size = UDim2.new(1, 10, 1, 10)
shadow.Position = UDim2.new(0, -5, 0, -5)
shadow.Image = "rbxassetid://5554236805"
shadow.ImageColor3 = Color3.new(0, 0, 0)
shadow.ImageTransparency = 0.8
shadow.ScaleType = Enum.ScaleType.Slice
shadow.SliceCenter = Rect.new(10, 10, 118, 118)

-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº Ñ Ð³Ñ€Ð°Ð´Ð¸ÐµÐ½Ñ‚Ð¾Ð¼
local titleFrame = Instance.new("Frame")
titleFrame.Name = "TitleFrame"
titleFrame.Parent = mainFrame
titleFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
titleFrame.BorderSizePixel = 0
titleFrame.Size = UDim2.new(1, 0, 0, 40)

local titleGradient = Instance.new("UIGradient")
titleGradient.Parent = titleFrame
titleGradient.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0, Color3.fromRGB(106, 90, 205)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(70, 130, 180))
})

local title = Instance.new("TextLabel")
title.Parent = titleFrame
title.BackgroundTransparency = 1
title.Size = UDim2.new(1, 0, 1, 0)
title.Font = Enum.Font.GothamBold
title.Text = "ULTIMATE CHEAT MENU v5.0"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.TextSize = 16

-- ÐšÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€ Ð´Ð»Ñ Ð²ÐºÐ»Ð°Ð´Ð¾Ðº
local tabContainer = Instance.new("Frame")
tabContainer.Name = "TabContainer"
tabContainer.Parent = mainFrame
tabContainer.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
tabContainer.BorderSizePixel = 0
tabContainer.Position = UDim2.new(0, 0, 0, 40)
tabContainer.Size = UDim2.new(1, 0, 0, 30)

-- ÐšÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€ Ð´Ð»Ñ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚Ð°
local contentFrame = Instance.new("ScrollingFrame")
contentFrame.Name = "ContentFrame"
contentFrame.Parent = mainFrame
contentFrame.BackgroundTransparency = 1
contentFrame.BorderSizePixel = 0
contentFrame.Position = UDim2.new(0, 0, 0, 70)
contentFrame.Size = UDim2.new(1, 0, 1, -70)
contentFrame.CanvasSize = UDim2.new(0, 0, 0, 800)
contentFrame.ScrollBarThickness = 3
contentFrame.ScrollBarImageColor3 = Color3.fromRGB(106, 90, 205)

-- Ð’ÐºÐ»Ð°Ð´ÐºÐ¸
local tabs = {"Main", "Visuals", "Aimbot", "Config"}
local currentTab = "Main"

local function createTab(name, position)
    local tab = Instance.new("TextButton")
    tab.Name = name .. "Tab"
    tab.Parent = tabContainer
    tab.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    tab.BorderSizePixel = 0
    tab.Position = position
    tab.Size = UDim2.new(0.25, 0, 1, 0)
    tab.Font = Enum.Font.Gotham
    tab.Text = name
    tab.TextColor3 = Color3.fromRGB(200, 200, 200)
    tab.TextSize = 12
    
    tab.MouseButton1Click:Connect(function()
        currentTab = name
        -- ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð²Ð¸Ð´Ð¸Ð¼Ð¾ÑÑ‚ÑŒ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚Ð°
        for _, child in pairs(contentFrame:GetChildren()) do
            if child:IsA("Frame") then
                child.Visible = child.Name == name .. "Content"
            end
        end
        -- ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð°ÐºÑ‚Ð¸Ð²Ð½ÑƒÑŽ Ð²ÐºÐ»Ð°Ð´ÐºÑƒ
        for _, t in pairs(tabContainer:GetChildren()) do
            if t:IsA("TextButton") then
                if t.Text == name then
                    t.BackgroundColor3 = Color3.fromRGB(106, 90, 205)
                    t.TextColor3 = Color3.fromRGB(255, 255, 255)
                else
                    t.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
                    t.TextColor3 = Color3.fromRGB(200, 200, 200)
                end
            end
        end
    end)
    
    return tab
end

-- Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð²ÐºÐ»Ð°Ð´ÐºÐ¸
for i, tabName in ipairs(tabs) do
    createTab(tabName, UDim2.new(0.25 * (i-1), 0, 0, 0))
end

-- Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð² UI
local function createSection(titleText, parent, position)
    local section = Instance.new("Frame")
    section.Name = titleText .. "Section"
    section.Parent = parent
    section.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    section.BorderSizePixel = 0
    section.Position = position
    section.Size = UDim2.new(0.9, 0, 0, 40)
    
    local sectionTitle = Instance.new("TextLabel")
    sectionTitle.Parent = section
    sectionTitle.BackgroundTransparency = 1
    sectionTitle.Position = UDim2.new(0.05, 0, 0, 5)
    sectionTitle.Size = UDim2.new(0.9, 0, 0, 20)
    sectionTitle.Font = Enum.Font.GothamBold
    sectionTitle.Text = titleText
    sectionTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
    sectionTitle.TextSize = 14
    sectionTitle.TextXAlignment = Enum.TextXAlignment.Left
    
    return section
end

local function createToggle(text, parent, position, configCategory, configField)
    local toggleFrame = Instance.new("Frame")
    toggleFrame.Parent = parent
    toggleFrame.BackgroundTransparency = 1
    toggleFrame.Position = position
    toggleFrame.Size = UDim2.new(0.9, 0, 0, 30)
    
    local toggleButton = Instance.new("TextButton")
    toggleButton.Parent = toggleFrame
    toggleButton.BackgroundColor3 = Config[configCategory][configField] and Color3.fromRGB(0, 150, 0) or Color3.fromRGB(60, 60, 60)
    toggleButton.BorderSizePixel = 0
    toggleButton.Position = UDim2.new(0, 0, 0, 0)
    toggleButton.Size = UDim2.new(0, 80, 0, 25)
    toggleButton.Font = Enum.Font.Gotham
    toggleButton.Text = Config[configCategory][configField] and "ON" or "OFF"
    toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    toggleButton.TextSize = 12
    
    local toggleLabel = Instance.new("TextLabel")
    toggleLabel.Parent = toggleFrame
    toggleLabel.BackgroundTransparency = 1
    toggleLabel.Position = UDim2.new(0.85, 0, 0, 0)
    toggleLabel.Size = UDim2.new(1, -90, 1, 0)
    toggleLabel.Font = Enum.Font.Gotham
    toggleLabel.Text = text
    toggleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    toggleLabel.TextSize = 12
    toggleLabel.TextXAlignment = Enum.TextXAlignment.Right
    
    toggleButton.MouseButton1Click:Connect(function()
        Config[configCategory][configField] = not Config[configCategory][configField]
        toggleButton.Text = Config[configCategory][configField] and "ON" or "OFF"
        toggleButton.BackgroundColor3 = Config[configCategory][configField] and Color3.fromRGB(0, 150, 0) or Color3.fromRGB(60, 60, 60)
        saveConfig()
        print("ðŸ”§ " .. text .. ": " .. (Config[configCategory][configField] and "ON" or "OFF"))
    end)
    
    return toggleButton
end

local function createSlider(text, parent, position, configCategory, configField, min, max)
    local sliderFrame = Instance.new("Frame")
    sliderFrame.Parent = parent
    sliderFrame.BackgroundTransparency = 1
    sliderFrame.Position = position
    sliderFrame.Size = UDim2.new(0.9, 0, 0, 50)
    
    local sliderLabel = Instance.new("TextLabel")
    sliderLabel.Parent = sliderFrame
    sliderLabel.BackgroundTransparency = 1
    sliderLabel.Position = UDim2.new(0, 0, 0, 0)
    sliderLabel.Size = UDim2.new(1, 0, 0, 20)
    sliderLabel.Font = Enum.Font.Gotham
    sliderLabel.Text = text .. ": " .. Config[configCategory][configField]
    sliderLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    sliderLabel.TextSize = 12
    sliderLabel.TextXAlignment = Enum.TextXAlignment.Left
    
    local sliderTrack = Instance.new("Frame")
    sliderTrack.Parent = sliderFrame
    sliderTrack.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    sliderTrack.BorderSizePixel = 0
    sliderTrack.Position = UDim2.new(0, 0, 0, 25)
    sliderTrack.Size = UDim2.new(1, 0, 0, 5)
    
    local sliderFill = Instance.new("Frame")
    sliderFill.Parent = sliderTrack
    sliderFill.BackgroundColor3 = Color3.fromRGB(106, 90, 205)
    sliderFill.BorderSizePixel = 0
    sliderFill.Size = UDim2.new((Config[configCategory][configField] - min) / (max - min), 0, 1, 0)
    
    local sliderButton = Instance.new("TextButton")
    sliderButton.Parent = sliderTrack
    sliderButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    sliderButton.BorderSizePixel = 0
    sliderButton.Size = UDim2.new(0, 15, 0, 15)
    sliderButton.Position = UDim2.new((Config[configCategory][configField] - min) / (max - min), -7, 0, -5)
    sliderButton.Text = ""
    
    local function updateSlider(value)
        local newValue = math.clamp(value, min, max)
        Config[configCategory][configField] = newValue
        sliderLabel.Text = text .. ": " .. newValue
        sliderFill.Size = UDim2.new((newValue - min) / (max - min), 0, 1, 0)
        sliderButton.Position = UDim2.new((newValue - min) / (max - min), -7, 0, -5)
        saveConfig()
    end
    
    sliderButton.MouseButton1Down:Connect(function()
        local connection
        connection = RunService.Heartbeat:Connect(function()
            local mousePos = UserInputService:GetMouseLocation()
            local trackPos = sliderTrack.AbsolutePosition
            local trackSize = sliderTrack.AbsoluteSize
            local relativeX = (mousePos.X - trackPos.X) / trackSize.X
            local value = min + (max - min) * relativeX
            updateSlider(value)
        end)
        
        UserInputService.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                connection:Disconnect()
            end
        end)
    end)
    
    return sliderFrame
end

-- Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ Ð´Ð»Ñ Ð²ÐºÐ»Ð°Ð´Ð¾Ðº
local function createTabContent(tabName)
    local content = Instance.new("Frame")
    content.Name = tabName .. "Content"
    content.Parent = contentFrame
    content.BackgroundTransparency = 1
    content.Size = UDim2.new(1, 0, 0, 400)
    content.Visible = currentTab == tabName
    
    if tabName == "Main" then
        createSection("Movement", content, UDim2.new(0.05, 0, 0, 10))
        createToggle("Speed Hack", content, UDim2.new(0.05, 0, 0.1, 0), "Speed", "Enabled")
        createSlider("Speed Value", content, UDim2.new(0.05, 0, 0.15, 0), "Speed", "Value", 16, 100)
        
        createToggle("High Jump", content, UDim2.new(0.05, 0, 0.25, 0), "Jump", "Enabled")
        createSlider("Jump Power", content, UDim2.new(0.05, 0, 0.30, 0), "Jump", "Value", 50, 200)
        
        createToggle("Fly", content, UDim2.new(0.05, 0, 0.40, 0), "Fly", "Enabled")
        createToggle("Noclip", content, UDim2.new(0.05, 0, 0.45, 0), "Noclip", "Enabled")
        
    elseif tabName == "Visuals" then
        createSection("Visual Features", content, UDim2.new(0.05, 0, 0, 10))
        createToggle("ESP", content, UDim2.new(0.05, 0, 0.1, 0), "ESP", "Enabled")
        createToggle("FOV Changer", content, UDim2.new(0.05, 0, 0.15, 0), "FOV", "Enabled")
        createSlider("FOV Value", content, UDim2.new(0.05, 0, 0.20, 0), "FOV", "Value", 70, 120)
        
    elseif tabName == "Aimbot" then
        createSection("Aimbot Settings", content, UDim2.new(0.05, 0, 0, 10))
        createToggle("Aimbot", content, UDim2.new(0.05, 0, 0.1, 0), "Aimbot", "Enabled")
        createSlider("Aimbot FOV", content, UDim2.new(0.05, 0, 0.15, 0), "Aimbot", "FOV", 50, 200)
        createSlider("Smoothness", content, UDim2.new(0.05, 0, 0.25, 0), "Aimbot", "Smoothness", 0.1, 1)
        
        createToggle("Ignore Team", content, UDim2.new(0.05, 0, 0.35, 0), "Aimbot", "IgnoreTeam")
        createToggle("Ignore Self", content, UDim2.new(0.05, 0, 0.40, 0), "Aimbot", "IgnoreSelf")
        
        createSection("Wallshoot", content, UDim2.new(0.05, 0, 0.50, 0))
        createToggle("Wallshoot", content, UDim2.new(0.05, 0, 0.55, 0), "Wallshoot", "Enabled")
        createToggle("Ignore Walls", content, UDim2.new(0.05, 0, 0.60, 0), "Wallshoot", "IgnoreWalls")
        createToggle("Ignore Map", content, UDim2.new(0.05, 0, 0.65, 0), "Wallshoot", "IgnoreMap")
        
    elseif tabName == "Config" then
        createSection("Configuration", content, UDim2.new(0.05, 0, 0, 10))
        
        local saveBtn = Instance.new("TextButton")
        saveBtn.Parent = content
        saveBtn.BackgroundColor3 = Color3.fromRGB(106, 90, 205)
        saveBtn.BorderSizePixel = 0
        saveBtn.Position = UDim2.new(0.05, 0, 0.1, 0)
        saveBtn.Size = UDim2.new(0.9, 0, 0, 30)
        saveBtn.Font = Enum.Font.GothamBold
        saveBtn.Text = "SAVE CONFIG"
        saveBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
        saveBtn.TextSize = 14
        
        saveBtn.MouseButton1Click:Connect(function()
            saveConfig()
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "CONFIG SAVED",
                Text = "Configuration saved successfully!",
                Duration = 3
            })
        end)
        
        local loadBtn = Instance.new("TextButton")
        loadBtn.Parent = content
        loadBtn.BackgroundColor3 = Color3.fromRGB(70, 130, 180)
        loadBtn.BorderSizePixel = 0
        loadBtn.Position = UDim2.new(0.05, 0, 0.2, 0)
        loadBtn.Size = UDim2.new(0.9, 0, 0, 30)
        loadBtn.Font = Enum.Font.GothamBold
        loadBtn.Text = "LOAD CONFIG"
        loadBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
        loadBtn.TextSize = 14
        
        loadBtn.MouseButton1Click:Connect(function()
            loadConfig()
            game:GetService("StarterGui"):SetCore("SendNotification", {
                Title = "CONFIG LOADED",
                Text = "Configuration loaded successfully!",
                Duration = 3
            })
        end)
        
        local infoLabel = Instance.new("TextLabel")
        infoLabel.Parent = content
        infoLabel.BackgroundTransparency = 1
        infoLabel.Position = UDim2.new(0.05, 0, 0.4, 0)
        infoLabel.Size = UDim2.new(0.9, 0, 0, 100)
        infoLabel.Font = Enum.Font.Gotham
        infoLabel.Text = "Hotkeys:\nInsert - Show/Hide Menu\nDelete - Destroy Menu\nF - Manual Aim\nF5 - Reset FOV"
        infoLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        infoLabel.TextSize = 12
        infoLabel.TextWrapped = true
        infoLabel.TextXAlignment = Enum.TextXAlignment.Left
    end
    
    return content
end

-- Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ Ð´Ð»Ñ Ð²ÑÐµÑ… Ð²ÐºÐ»Ð°Ð´Ð¾Ðº
for _, tabName in ipairs(tabs) do
    createTabContent(tabName)
end

-- Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹
local highlights = {}
local flyBodyVelocity
local noclipConnection
local aimbotConnection
local wallshootConnection
local fovCircle

-- Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐµÐ³Ð¾ Ð²Ñ€Ð°Ð³Ð°
local function getClosestEnemy()
    local closestPlayer = nil
    local closestDistance = math.huge
    local localRoot = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    local camera = workspace.CurrentCamera
    
    if not localRoot or not camera then return nil end
    
    for _, otherPlayer in pairs(Players:GetPlayers()) do
        -- Ð˜Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÐ¼ ÑÐµÐ±Ñ ÐµÑÐ»Ð¸ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾
        if Config.Aimbot.IgnoreSelf and otherPlayer == player then
            continue
        end
        
        -- Ð˜Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÐ¼ Ñ‚Ð¸Ð¼Ð¼ÐµÐ¹Ñ‚Ð¾Ð² ÐµÑÐ»Ð¸ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾
        if Config.Aimbot.IgnoreTeam and player.Team and otherPlayer.Team and player.Team == otherPlayer.Team then
            continue
        end
        
        if otherPlayer.Character then
            local targetPart = otherPlayer.Character:FindFirstChild(Config.Aimbot.Target) or 
                              otherPlayer.Character:FindFirstChild("HumanoidRootPart")
            local humanoid = otherPlayer.Character:FindFirstChildOfClass("Humanoid")
            
            if targetPart and humanoid and humanoid.Health > 0 then
                local distance = (localRoot.Position - targetPart.Position).Magnitude
                if distance < closestDistance then
                    closestDistance = distance
                    closestPlayer = otherPlayer
                end
            end
        end
    end
    
    return closestPlayer
end

-- Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Wallshoot
local originalRaycast
local function setupWallshoot()
    if Config.Wallshoot.Enabled then
        originalRaycast = workspace.FindPartOnRayWithIgnoreList
        
        workspace.FindPartOnRayWithIgnoreList = function(workspace, ray, ignoreList, ...)
            local newIgnoreList = {}
            
            if ignoreList then
                for _, item in ipairs(ignoreList) do
                    table.insert(newIgnoreList, item)
                end
            end
            
            if Config.Wallshoot.IgnoreWalls then
                for _, part in ipairs(Workspace:GetDescendants()) do
                    if part:IsA("BasePart") and (
                       part.Name:lower():find("wall") or 
                       part.Name:lower():find("part") or 
                       part.Name:lower():find("floor") or 
                       part.Name:lower():find("ceiling") or
                       part.Name:lower():find("barrier")) then
                        table.insert(newIgnoreList, part)
                    end
                end
            end
            
            if Config.Wallshoot.IgnoreMap then
                for _, part in ipairs(Workspace:GetChildren()) do
                    if part:IsA("Model") and part.Name:lower():find("map") then
                        for _, child in ipairs(part:GetDescendants()) do
                            if child:IsA("BasePart") then
                                table.insert(newIgnoreList, child)
                            end
                        end
                    end
                end
            end
            
            return originalRaycast(workspace, ray, newIgnoreList, ...)
        end
    else
        if originalRaycast then
            workspace.FindPartOnRayWithIgnoreList = originalRaycast
        end
    end
end

-- ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ñ†Ð¸ÐºÐ»
RunService.Heartbeat:Connect(function()
    -- Speed Hack
    local humanoid = player.Character and player.Character:FindFirstChild("Humanoid")
    if humanoid then
        if Config.Speed.Enabled then
            humanoid.WalkSpeed = Config.Speed.Value
        else
            humanoid.WalkSpeed = 16
        end
        
        if Config.Jump.Enabled then
            humanoid.JumpPower = Config.Jump.Value
        else
            humanoid.JumpPower = 50
        end
    end
    
    -- Noclip
    if Config.Noclip.Enabled and player.Character then
        for _, part in pairs(player.Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
    
    -- Fly
    if Config.Fly.Enabled then
        if not flyBodyVelocity and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            flyBodyVelocity = Instance.new("BodyVelocity")
            flyBodyVelocity.Velocity = Vector3.new(0, 0, 0)
            flyBodyVelocity.MaxForce = Vector3.new(40000, 40000, 40000)
            flyBodyVelocity.Parent = player.Character.HumanoidRootPart
        end
        
        if flyBodyVelocity then
            local cam = workspace.CurrentCamera
            local moveDir = Vector3.new(0, 0, 0)
            
            if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveDir = moveDir + cam.CFrame.LookVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveDir = moveDir - cam.CFrame.LookVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveDir = moveDir - cam.CFrame.RightVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveDir = moveDir + cam.CFrame.RightVector end
            if UserInputService:IsKeyDown(Enum.KeyCode.Space) then moveDir = moveDir + Vector3.new(0, 1, 0) end
            if UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then moveDir = moveDir - Vector3.new(0, 1, 0) end
            
            flyBodyVelocity.Velocity = moveDir * Config.Fly.Speed
        end
    else
        if flyBodyVelocity then
            flyBodyVelocity:Destroy()
            flyBodyVelocity = nil
        end
    end
    
    -- FOV Changer
    local camera = workspace.CurrentCamera
    if camera then
        if Config.FOV.Enabled then
            camera.FieldOfView = Config.FOV.Value
        else
            camera.FieldOfView = 70
        end
    end
    
    -- Aimbot
    if Config.Aimbot.Enabled then
        local closestEnemy = getClosestEnemy()
        if closestEnemy and closestEnemy.Character then
            local targetPart = closestEnemy.Character:FindFirstChild(Config.Aimbot.Target) or 
                              closestEnemy.Character:FindFirstChild("HumanoidRootPart")
            local camera = workspace.CurrentCamera
            if targetPart and camera then
                local currentCFrame = camera.CFrame
                local targetCFrame = CFrame.new(camera.CFrame.Position, targetPart.Position)
                camera.CFrame = currentCFrame:Lerp(targetCFrame, Config.Aimbot.Smoothness)
            end
        end
    end
    
    -- Wallshoot
    setupWallshoot()
end)

-- ESP System
local function updateESP()
    for _, otherPlayer in pairs(Players:GetPlayers()) do
        if otherPlayer ~= player and otherPlayer.Character then
            if Config.ESP.Enabled then
                if not highlights[otherPlayer] then
                    local highlight = Instance.new("Highlight")
                    highlight.FillTransparency = Config.ESP.Transparency
                    highlight.OutlineTransparency = 0
                    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
                    highlight.Parent = otherPlayer.Character
                    highlight.Adornee = otherPlayer.Character
                    highlights[otherPlayer] = highlight
                end
                
                -- Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ñ†Ð²ÐµÑ‚
                local color = Config.ESP.NeutralColor
                if player.Team and otherPlayer.Team then
                    if player.Team == otherPlayer.Team then
                        color = Config.ESP.TeamColor
                    else
                        color = Config.ESP.EnemyColor
                    end
                end
                
                highlights[otherPlayer].FillColor = color
                highlights[otherPlayer].OutlineColor = color
                
            else
                if highlights[otherPlayer] then
                    highlights[otherPlayer]:Destroy()
                    highlights[otherPlayer] = nil
                end
            end
        end
    end
end

-- ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ ESP Ð¿Ñ€Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº
RunService.Heartbeat:Connect(updateESP)

-- Ð“Ð¾Ñ€ÑÑ‡Ð¸Ðµ ÐºÐ»Ð°Ð²Ð¸ÑˆÐ¸
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Config.Menu.Keybind then
        mainFrame.Visible = not mainFrame.Visible
    elseif input.KeyCode == Config.Menu.DestroyKey then
        screenGui:Destroy()
        if fovCircle then fovCircle:Remove() end
    elseif input.KeyCode == Config.Menu.ManualAimKey then
        local closestEnemy = getClosestEnemy()
        if closestEnemy and closestEnemy.Character then
            local targetPart = closestEnemy.Character:FindFirstChild("Head") or 
                              closestEnemy.Character:FindFirstChild("HumanoidRootPart")
            local camera = workspace.CurrentCamera
            if targetPart and camera then
                camera.CFrame = CFrame.new(camera.CFrame.Position, targetPart.Position)
            end
        end
    elseif input.KeyCode == Config.Menu.FOVResetKey then
        local camera = workspace.CurrentCamera
        if camera then
            camera.FieldOfView = 70
            Config.FOV.Enabled = false
        end
    end
end)

print("âœ… Ultimate Cheat Menu v5.0 Loaded!")
print("ðŸŽ¯ Features: Aimbot, ESP, Wallshoot, Config System")
print("ðŸ’¾ Config: Auto-save/load enabled")

-- Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "ULTIMATE MENU v5.0 LOADED",
    Text = "With Config System & Wallshoot!",
    Duration = 5
})
