local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")

local player = Players.LocalPlayer
local mouse = player:GetMouse()
local main = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local TabButtonsFrame = Instance.new("Frame")
local ContentFrame = Instance.new("Frame")

-- ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸
local speeds = 1
local isFlying = false
local isNoClip = false
local isESPEnabled = false
local isAimbotEnabled = false
local currentTab = "Fly"
local tpwalking = false

-- Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ GUI
main.Name = "Script"
main.Parent = CoreGui
main.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
main.ResetOnSpawn = false

MainFrame.Name = "MainFrame"
MainFrame.Parent = main
MainFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.1, 0, 0.3, 0)
MainFrame.Size = UDim2.new(0, 350, 0, 400)
MainFrame.Active = true
MainFrame.Draggable = true

local TitleFrame = Instance.new("Frame")
TitleFrame.Name = "TitleFrame"
TitleFrame.Parent = MainFrame
TitleFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
TitleFrame.BorderSizePixel = 0
TitleFrame.Size = UDim2.new(1, 0, 0, 40)

local TitleLabel = Instance.new("TextLabel")
TitleLabel.Name = "TitleLabel"
TitleLabel.Parent = TitleFrame
TitleLabel.BackgroundTransparency = 1
TitleLabel.Size = UDim2.new(1, -80, 1, 0)
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.Text = "SCRIPT"
TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleLabel.TextSize = 16

local CloseButton = Instance.new("TextButton")
CloseButton.Name = "CloseButton"
CloseButton.Parent = TitleFrame
CloseButton.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
CloseButton.BorderSizePixel = 0
CloseButton.Position = UDim2.new(1, -30, 0.5, -10)
CloseButton.Size = UDim2.new(0, 20, 0, 20)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.Text = "X"
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.TextSize = 12

TabButtonsFrame.Name = "TabButtonsFrame"
TabButtonsFrame.Parent = MainFrame
TabButtonsFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
TabButtonsFrame.BorderSizePixel = 0
TabButtonsFrame.Position = UDim2.new(0, 0, 0, 40)
TabButtonsFrame.Size = UDim2.new(0, 100, 0, 360)

ContentFrame.Name = "ContentFrame"
ContentFrame.Parent = MainFrame
ContentFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
ContentFrame.BorderSizePixel = 0
ContentFrame.Position = UDim2.new(0, 100, 0, 40)
ContentFrame.Size = UDim2.new(0, 250, 0, 360)

-- Ð’ÑÐ¿Ð¾Ð¼Ð¾Ð³Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸
local function createButton(parent, text, position, size, color)
    local button = Instance.new("TextButton")
    button.Parent = parent
    button.BackgroundColor3 = color
    button.BorderSizePixel = 0
    button.Position = position
    button.Size = size
    button.Font = Enum.Font.Gotham
    button.Text = text
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.TextSize = 12
    button.AutoButtonColor = false
    return button
end

local function createLabel(parent, text, position, size)
    local label = Instance.new("TextLabel")
    label.Parent = parent
    label.BackgroundTransparency = 1
    label.Position = position
    label.Size = size
    label.Font = Enum.Font.Gotham
    label.Text = text
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.TextSize = 12
    label.TextXAlignment = Enum.TextXAlignment.Center
    return label
end

-- Ð’ÐºÐ»Ð°Ð´ÐºÐ¸
local tabs = {
    Fly = {name = "Fly", color = Color3.fromRGB(86, 156, 214), icon = "âœˆï¸"},
    NoClip = {name = "NoClip", color = Color3.fromRGB(106, 214, 86), icon = "ðŸ‘»"},
    ESP = {name = "ESP", color = Color3.fromRGB(214, 86, 186), icon = "ðŸ‘ï¸"},
    Aimbot = {name = "Aimbot", color = Color3.fromRGB(214, 86, 86), icon = "ðŸŽ¯"},
    Settings = {name = "Settings", color = Color3.fromRGB(214, 174, 86), icon = "âš™ï¸"}
}

local tabButtons = {}
local tabFrames = {}

local function switchTab(tabName)
    currentTab = tabName
    for name, frame in pairs(tabFrames) do
        frame.Visible = false
    end
    for name, button in pairs(tabButtons) do
        button.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    end
    if tabFrames[tabName] then
        tabFrames[tabName].Visible = true
    end
    if tabButtons[tabName] then
        tabButtons[tabName].BackgroundColor3 = tabs[tabName].color
    end
end

local index = 1
for tabName, tabData in pairs(tabs) do
    local button = Instance.new("TextButton")
    button.Name = tabName .. "Tab"
    button.Parent = TabButtonsFrame
    button.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    button.BorderSizePixel = 0
    button.Position = UDim2.new(0, 0, 0, (index-1) * 60)
    button.Size = UDim2.new(1, 0, 0, 60)
    button.Font = Enum.Font.Gotham
    button.Text = tabData.icon .. "\n" .. tabData.name
    button.TextColor3 = Color3.fromRGB(200, 200, 200)
    button.TextSize = 12
    button.TextWrapped = true
    
    local contentFrame = Instance.new("Frame")
    contentFrame.Name = tabName .. "Content"
    contentFrame.Parent = ContentFrame
    contentFrame.BackgroundTransparency = 1
    contentFrame.Size = UDim2.new(1, 0, 1, 0)
    contentFrame.Visible = false
    
    tabButtons[tabName] = button
    tabFrames[tabName] = contentFrame
    
    button.MouseButton1Click:Connect(function()
        switchTab(tabName)
    end)
    index += 1
end

-- Fly Tab
local FlyContent = tabFrames.Fly
local FlyToggle = createButton(FlyContent, "Enable Fly", UDim2.new(0.1, 0, 0.1, 0), UDim2.new(0.8, 0, 0, 40), tabs.Fly.color)
local SpeedLabel = createLabel(FlyContent, "Flight Speed: 1", UDim2.new(0.1, 0, 0.3, 0), UDim2.new(0.8, 0, 0, 20))

-- NoClip Tab
local NoClipContent = tabFrames.NoClip
local NoClipToggle = createButton(NoClipContent, "Enable NoClip", UDim2.new(0.1, 0, 0.2, 0), UDim2.new(0.8, 0, 0, 40), tabs.NoClip.color)

-- ESP Tab
local ESPContent = tabFrames.ESP
local ESPToggle = createButton(ESPContent, "Enable ESP", UDim2.new(0.1, 0, 0.1, 0), UDim2.new(0.8, 0, 0, 40), tabs.ESP.color)

-- Aimbot Tab
local AimbotContent = tabFrames.Aimbot
local AimbotToggle = createButton(AimbotContent, "Enable Aimbot", UDim2.new(0.1, 0, 0.1, 0), UDim2.new(0.8, 0, 0, 40), tabs.Aimbot.color)
local AimbotInfo = createLabel(AimbotContent, "Hold RightMouse to aim", UDim2.new(0.1, 0, 0.6, 0), UDim2.new(0.8, 0, 0, 50))
AimbotInfo.TextWrapped = true
AimbotInfo.TextColor3 = Color3.fromRGB(150, 150, 150)

-- Settings Tab
local SettingsContent = tabFrames.Settings
local SettingsInfo = createLabel(SettingsContent, "SCRIPT\nBy XNEO", UDim2.new(0.1, 0, 0.7, 0), UDim2.new(0.8, 0, 0, 80))
SettingsInfo.TextWrapped = true
SettingsInfo.TextColor3 = Color3.fromRGB(200, 200, 200)

-- Flight System
local flightConnections = {}
local flightParts = {}

local function enableFlight()
    if isFlying then return end
    isFlying = true
    FlyToggle.Text = "Disable Fly"
    FlyToggle.BackgroundColor3 = Color3.fromRGB(214, 86, 86)
    
    local character = player.Character
    if not character then return end
    
    local humanoid = character:FindFirstChildWhichIsA("Humanoid")
    if not humanoid then return end
    
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return end
    
    local bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.Velocity = Vector3.new(0, 0, 0)
    bodyVelocity.MaxForce = Vector3.new(40000, 40000, 40000)
    bodyVelocity.Parent = rootPart
    
    local flightConnection
    flightConnection = RunService.Heartbeat:Connect(function()
        if not isFlying or not character then
            if flightConnection then flightConnection:Disconnect() end
            return
        end
        
        local cam = workspace.CurrentCamera
        local moveDirection = Vector3.new(0, 0, 0)
        
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveDirection = moveDirection + cam.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveDirection = moveDirection - cam.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveDirection = moveDirection - cam.CFrame.RightVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveDirection = moveDirection + cam.CFrame.RightVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.Space) then moveDirection = moveDirection + Vector3.new(0, 1, 0) end
        if UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then moveDirection = moveDirection - Vector3.new(0, 1, 0) end
        
        bodyVelocity.Velocity = moveDirection * (speeds * 50)
    end)
    
    flightConnections = {flightConnection}
    flightParts = {bodyVelocity}
end

local function disableFlight()
    if not isFlying then return end
    isFlying = false
    FlyToggle.Text = "Enable Fly"
    FlyToggle.BackgroundColor3 = tabs.Fly.color
    
    for _, conn in pairs(flightConnections) do
        if conn then conn:Disconnect() end
    end
    for _, part in pairs(flightParts) do
        if part then part:Destroy() end
    end
end

-- NoClip System
local noClipConnection

local function enableNoClip()
    if isNoClip then return end
    isNoClip = true
    NoClipToggle.Text = "Disable NoClip"
    NoClipToggle.BackgroundColor3 = Color3.fromRGB(214, 86, 86)
    
    noClipConnection = RunService.Stepped:Connect(function()
        if not isNoClip then return end
        local character = player.Character
        if character then
            for _, part in pairs(character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = false
                end
            end
        end
    end)
end

local function disableNoClip()
    if not isNoClip then return end
    isNoClip = false
    NoClipToggle.Text = "Enable NoClip"
    NoClipToggle.BackgroundColor3 = tabs.NoClip.color
    
    if noClipConnection then
        noClipConnection:Disconnect()
    end
end

-- ESP System
local espHighlights = {}

local function enableESP()
    if isESPEnabled then return end
    isESPEnabled = true
    ESPToggle.Text = "Disable ESP"
    ESPToggle.BackgroundColor3 = Color3.fromRGB(214, 86, 86)
    
    for _, otherPlayer in pairs(Players:GetPlayers()) do
        if otherPlayer ~= player and otherPlayer.Character then
            local highlight = Instance.new("Highlight")
            highlight.Parent = otherPlayer.Character
            highlight.Adornee = otherPlayer.Character
            highlight.FillColor = Color3.new(1, 0, 0)
            highlight.OutlineColor = Color3.new(1, 1, 1)
            highlight.FillTransparency = 0.5
            espHighlights[otherPlayer] = highlight
        end
    end
end

local function disableESP()
    if not isESPEnabled then return end
    isESPEnabled = false
    ESPToggle.Text = "Enable ESP"
    ESPToggle.BackgroundColor3 = tabs.ESP.color
    
    for _, highlight in pairs(espHighlights) do
        if highlight then highlight:Destroy() end
    end
    espHighlights = {}
end

-- AIMBOT SYSTEM
local aimbotConnection
local aimKey = Enum.UserInputType.MouseButton2

local function getClosestPlayer()
    local closestPlayer = nil
    local closestDistance = math.huge
    local localRoot = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
    
    if not localRoot then return nil end
    
    for _, otherPlayer in pairs(Players:GetPlayers()) do
        if otherPlayer ~= player and otherPlayer.Character then
            local targetRoot = otherPlayer.Character:FindFirstChild("HumanoidRootPart")
            local humanoid = otherPlayer.Character:FindFirstChildWhichIsA("Humanoid")
            
            if targetRoot and humanoid and humanoid.Health > 0 then
                local distance = (localRoot.Position - targetRoot.Position).Magnitude
                if distance < closestDistance then
                    closestDistance = distance
                    closestPlayer = otherPlayer
                end
            end
        end
    end
    
    return closestPlayer
end

local function aimAtPlayer(targetPlayer)
    if not targetPlayer or not targetPlayer.Character then return end
    
    local targetRoot = targetPlayer.Character:FindFirstChild("HumanoidRootPart")
    local camera = workspace.CurrentCamera
    
    if targetRoot and camera then
        camera.CFrame = CFrame.new(camera.CFrame.Position, targetRoot.Position)
    end
end

local function enableAimbot()
    if isAimbotEnabled then return end
    
    isAimbotEnabled = true
    AimbotToggle.Text = "Disable Aimbot"
    AimbotToggle.BackgroundColor3 = Color3.fromRGB(214, 86, 86)
    
    aimbotConnection = RunService.Heartbeat:Connect(function()
        if not isAimbotEnabled then return end
        
        if UserInputService:IsMouseButtonPressed(Enum.UserInputType.MouseButton2) then
            local closestPlayer = getClosestPlayer()
            if closestPlayer then
                aimAtPlayer(closestPlayer)
            end
        end
    end)
end

local function disableAimbot()
    if not isAimbotEnabled then return end
    
    isAimbotEnabled = false
    AimbotToggle.Text = "Enable Aimbot"
    AimbotToggle.BackgroundColor3 = tabs.Aimbot.color
    
    if aimbotConnection then
        aimbotConnection:Disconnect()
    end
end

-- ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ ÐºÐ½Ð¾Ð¿Ð¾Ðº
FlyToggle.MouseButton1Click:Connect(function()
    if isFlying then disableFlight() else enableFlight() end
end)

NoClipToggle.MouseButton1Click:Connect(function()
    if isNoClip then disableNoClip() else enableNoClip() end
end)

ESPToggle.MouseButton1Click:Connect(function()
    if isESPEnabled then disableESP() else enableESP() end
end)

AimbotToggle.MouseButton1Click:Connect(function()
    if isAimbotEnabled then disableAimbot() else enableAimbot() end
end)

CloseButton.MouseButton1Click:Connect(function()
    disableFlight()
    disableNoClip()
    disableESP()
    disableAimbot()
    main:Destroy()
end)

-- Ð“Ð¾Ñ€ÑÑ‡Ð¸Ðµ ÐºÐ»Ð°Ð²Ð¸ÑˆÐ¸
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode.Insert then
        MainFrame.Visible = not MainFrame.Visible
    elseif input.KeyCode == Enum.KeyCode.Delete then
        disableFlight()
        disableNoClip()
        disableESP()
        disableAimbot()
    elseif input.KeyCode == Enum.KeyCode.End then
        main:Destroy()
    end
end)

-- Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ
switchTab("Fly")

-- Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "SCRIPT LOADED",
    Text = "RightMouse - Aimbot | Insert - GUI",
    Duration = 5
})

print("SCRIPT loaded! RightMouse for Aimbot")
