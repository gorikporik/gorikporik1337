local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")
local Lighting = game:GetService("Lighting")
local HttpService = game:GetService("HttpService")

local player = Players.LocalPlayer
local mouse = player:GetMouse()

-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏
local settings = {
    speed = 1,
    isFlying = false,
    isNoClip = false,
    isESPEnabled = false,
    isSpeedHack = false,
    isAimbot = false,
    isBhop = false,
    isAntiAFK = false,
    isFullbright = false,
    espNames = true,
    espDistance = true,
    espBoxes = true,
    speedHackValue = 2,
    bhopSpeed = 1.5,
    
    -- –ö–∞—Å—Ç–æ–º–Ω—ã–µ –±–∏–Ω–¥—ã
    keybinds = {
        fly = Enum.KeyCode.F,
        noclip = Enum.KeyCode.V,
        esp = Enum.KeyCode.X,
        aimbot = Enum.KeyCode.Q,
        bhop = Enum.KeyCode.Space,
        speedhack = Enum.KeyCode.LeftShift
    }
}

local currentTab = "Movement"
local tpwalking = false
local flightConnections = {}
local flightParts = {}
local espHighlights = {}
local aimbotConnection
local bhopConnection
local antiAFKConnection
local fullbrightConnection

-- –°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ GUI
local main = Instance.new("ScreenGui")
main.Name = "MinecraftStyleGUI"
main.Parent = CoreGui
main.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
main.ResetOnSpawn = false

-- –ì–ª–∞–≤–Ω—ã–π —Ñ—Ä–µ–π–º
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = main
MainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
MainFrame.BorderSizePixel = 2
MainFrame.BorderColor3 = Color3.fromRGB(80, 80, 80)
MainFrame.Position = UDim2.new(0.1, 0, 0.2, 0)
MainFrame.Size = UDim2.new(0, 450, 0, 500)
MainFrame.Active = true
MainFrame.Draggable = true

-- –¢–µ–Ω—å
local Shadow = Instance.new("Frame")
Shadow.Name = "Shadow"
Shadow.Parent = MainFrame
Shadow.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Shadow.BackgroundTransparency = 0.7
Shadow.BorderSizePixel = 0
Shadow.Position = UDim2.new(0, 4, 0, 4)
Shadow.Size = UDim2.new(1, 0, 1, 0)
Shadow.ZIndex = -1

-- –ó–∞–≥–æ–ª–æ–≤–æ–∫
local TitleFrame = Instance.new("Frame")
TitleFrame.Name = "TitleFrame"
TitleFrame.Parent = MainFrame
TitleFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
TitleFrame.BorderSizePixel = 2
TitleFrame.BorderColor3 = Color3.fromRGB(80, 80, 80)
TitleFrame.Size = UDim2.new(1, 0, 0, 35)

local TitleLabel = Instance.new("TextLabel")
TitleLabel.Name = "TitleLabel"
TitleLabel.Parent = TitleFrame
TitleLabel.BackgroundTransparency = 1
TitleLabel.Size = UDim2.new(1, -80, 1, 0)
TitleLabel.Font = Enum.Font.SourceSansBold
TitleLabel.Text = "ADVANCED CHEATS V6"
TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleLabel.TextSize = 16

-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–∫–Ω–æ–º
local CloseButton = createMinecraftButton(TitleFrame, "X", UDim2.new(1, -30, 0.5, -10), UDim2.new(0, 25, 0, 25), Color3.fromRGB(200, 60, 60))
local MinimizeButton = createMinecraftButton(TitleFrame, "_", UDim2.new(1, -60, 0.5, -10), UDim2.new(0, 25, 0, 25), Color3.fromRGB(200, 160, 60))

-- –§—Ä–µ–π–º –¥–ª—è –∫–Ω–æ–ø–æ–∫ –≤–∫–ª–∞–¥–æ–∫
local TabButtonsFrame = Instance.new("Frame")
TabButtonsFrame.Name = "TabButtonsFrame"
TabButtonsFrame.Parent = MainFrame
TabButtonsFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
TabButtonsFrame.BorderSizePixel = 2
TabButtonsFrame.BorderColor3 = Color3.fromRGB(80, 80, 80)
TabButtonsFrame.Position = UDim2.new(0, 0, 0, 35)
TabButtonsFrame.Size = UDim2.new(0, 120, 0, 465)

-- –§—Ä–µ–π–º –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Parent = MainFrame
ContentFrame.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
ContentFrame.BorderSizePixel = 2
ContentFrame.BorderColor3 = Color3.fromRGB(80, 80, 80)
ContentFrame.Position = UDim2.new(0, 120, 0, 35)
ContentFrame.Size = UDim2.new(0, 330, 0, 465)

-- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
function createMinecraftButton(parent, text, position, size, color)
    local button = Instance.new("TextButton")
    button.Parent = parent
    button.BackgroundColor3 = color
    button.BorderSizePixel = 2
    button.BorderColor3 = Color3.fromRGB(100, 100, 100)
    button.Position = position
    button.Size = size
    button.Font = Enum.Font.SourceSansBold
    button.Text = text
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.TextSize = 14
    button.AutoButtonColor = false
    
    button.MouseButton1Down:Connect(function()
        button.BackgroundColor3 = Color3.fromRGB(
            math.max(color.R * 255 - 30, 0),
            math.max(color.G * 255 - 30, 0),
            math.max(color.B * 255 - 30, 0)
        )
        button.Position = button.Position + UDim2.new(0, 1, 0, 1)
    end)
    
    button.MouseButton1Up:Connect(function()
        button.BackgroundColor3 = color
        button.Position = button.Position - UDim2.new(0, 1, 0, 1)
    end)
    
    button.MouseEnter:Connect(function()
        button.BorderColor3 = Color3.fromRGB(150, 150, 150)
    end)
    
    button.MouseLeave:Connect(function()
        button.BorderColor3 = Color3.fromRGB(100, 100, 100)
    end)
    
    return button
end

function createMinecraftLabel(parent, text, position, size)
    local label = Instance.new("TextLabel")
    label.Parent = parent
    label.BackgroundTransparency = 1
    label.Position = position
    label.Size = size
    label.Font = Enum.Font.SourceSans
    label.Text = text
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.TextSize = 14
    label.TextXAlignment = Enum.TextXAlignment.Left
    
    return label
end

function createMinecraftToggle(parent, text, position, defaultValue, callback)
    local toggleFrame = Instance.new("Frame")
    toggleFrame.Parent = parent
    toggleFrame.BackgroundTransparency = 1
    toggleFrame.Position = position
    toggleFrame.Size = UDim2.new(0.9, 0, 0, 30)
    
    local label = createMinecraftLabel(toggleFrame, text, UDim2.new(0, 35, 0, 0), UDim2.new(1, -35, 1, 0))
    
    local toggleButton = Instance.new("TextButton")
    toggleButton.Parent = toggleFrame
    toggleButton.BackgroundColor3 = defaultValue and Color3.fromRGB(100, 200, 100) or Color3.fromRGB(200, 100, 100)
    toggleButton.BorderSizePixel = 2
    toggleButton.BorderColor3 = Color3.fromRGB(100, 100, 100)
    toggleButton.Position = UDim2.new(0, 5, 0.5, -10)
    toggleButton.Size = UDim2.new(0, 20, 0, 20)
    toggleButton.Text = ""
    
    toggleButton.MouseButton1Click:Connect(function()
        local newValue = not defaultValue
        toggleButton.BackgroundColor3 = newValue and Color3.fromRGB(100, 200, 100) or Color3.fromRGB(200, 100, 100)
        defaultValue = newValue
        callback(newValue)
    end)
    
    return {frame = toggleFrame, button = toggleButton, value = defaultValue}
end

function createMinecraftSlider(parent, text, position, minValue, maxValue, currentValue, callback)
    local sliderFrame = Instance.new("Frame")
    sliderFrame.Parent = parent
    sliderFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    sliderFrame.BorderSizePixel = 2
    sliderFrame.BorderColor3 = Color3.fromRGB(80, 80, 80)
    sliderFrame.Position = position
    sliderFrame.Size = UDim2.new(0.9, 0, 0, 50)
    
    local label = createMinecraftLabel(sliderFrame, text..": "..currentValue, UDim2.new(0, 5, 0, 0), UDim2.new(1, -10, 0, 20))
    
    local track = Instance.new("Frame")
    track.Parent = sliderFrame
    track.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    track.BorderSizePixel = 0
    track.Position = UDim2.new(0, 5, 0, 30)
    track.Size = UDim2.new(1, -10, 0, 10)
    
    local fill = Instance.new("Frame")
    fill.Parent = track
    fill.BackgroundColor3 = Color3.fromRGB(100, 200, 100)
    fill.BorderSizePixel = 0
    fill.Size = UDim2.new((currentValue - minValue) / (maxValue - minValue), 0, 1, 0)
    
    local button = Instance.new("TextButton")
    button.Parent = track
    button.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    button.BorderSizePixel = 2
    button.BorderColor3 = Color3.fromRGB(100, 100, 100)
    button.Size = UDim2.new(0, 15, 0, 15)
    button.Position = UDim2.new((currentValue - minValue) / (maxValue - minValue), -7, 0, -2)
    button.Text = ""
    
    local dragging = false
    
    button.MouseButton1Down:Connect(function()
        dragging = true
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    
    game:GetService("UserInputService").InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local mousePos = UserInputService:GetMouseLocation()
            local trackPos = track.AbsolutePosition
            local trackSize = track.AbsoluteSize
            
            local relativeX = math.clamp((mousePos.X - trackPos.X) / trackSize.X, 0, 1)
            local value = math.floor((minValue + (maxValue - minValue) * relativeX) * 10) / 10
            
            fill.Size = UDim2.new(relativeX, 0, 1, 0)
            button.Position = UDim2.new(relativeX, -7, 0, -2)
            label.Text = text..": "..value
            
            callback(value)
        end
    end)
    
    return sliderFrame
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–æ–ø–∫–∏ –±–∏–Ω–¥–∞
function createBindButton(parent, text, currentKey, position, callback)
    local bindFrame = Instance.new("Frame")
    bindFrame.Parent = parent
    bindFrame.BackgroundTransparency = 1
    bindFrame.Position = position
    bindFrame.Size = UDim2.new(0.9, 0, 0, 30)
    
    local label = createMinecraftLabel(bindFrame, text, UDim2.new(0, 0, 0, 0), UDim2.new(0.6, 0, 1, 0))
    
    local bindButton = createMinecraftButton(bindFrame, currentKey.Name, UDim2.new(0.6, 0, 0, 0), UDim2.new(0.4, 0, 1, 0), Color3.fromRGB(80, 80, 80))
    
    local listening = false
    
    bindButton.MouseButton1Click:Connect(function()
        if not listening then
            listening = true
            bindButton.Text = "..."
            bindButton.BackgroundColor3 = Color3.fromRGB(200, 200, 100)
            
            local connection
            connection = UserInputService.InputBegan:Connect(function(input, gameProcessed)
                if gameProcessed then return end
                
                if input.UserInputType == Enum.UserInputType.Keyboard then
                    listening = false
                    bindButton.Text = input.KeyCode.Name
                    bindButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
                    callback(input.KeyCode)
                    connection:Disconnect()
                end
            end)
        end
    end)
    
    return bindButton
end

-- –°–æ–∑–¥–∞–µ–º –≤–∫–ª–∞–¥–∫–∏
local tabs = {
    Movement = {name = "Movement", color = Color3.fromRGB(86, 156, 214), icon = "üèÉ"},
    Visuals = {name = "Visuals", color = Color3.fromRGB(106, 214, 86), icon = "üëÅÔ∏è"},
    Combat = {name = "Combat", color = Color3.fromRGB(214, 86, 86), icon = "üéØ"},
    Utility = {name = "Utility", color = Color3.fromRGB(214, 174, 86), icon = "üîß"},
    Keybinds = {name = "Keybinds", color = Color3.fromRGB(174, 86, 214), icon = "‚å®Ô∏è"},
    Settings = {name = "Settings", color = Color3.fromRGB(86, 214, 214), icon = "‚öôÔ∏è"}
}

local tabButtons = {}
local tabFrames = {}

for tabName, tabData in pairs(tabs) do
    local button = createMinecraftButton(TabButtonsFrame, tabData.icon.." "..tabData.name, 
        UDim2.new(0, 5, 0, 5 + (#tabButtons * 45)), UDim2.new(1, -10, 0, 40), Color3.fromRGB(50, 50, 50))
    
    local contentFrame = Instance.new("Frame")
    contentFrame.Name = tabName.."Content"
    contentFrame.Parent = ContentFrame
    contentFrame.BackgroundTransparency = 1
    contentFrame.Size = UDim2.new(1, 0, 1, 0)
    contentFrame.Visible = false
    
    tabButtons[tabName] = button
    tabFrames[tabName] = contentFrame
    
    button.MouseButton1Click:Connect(function()
        switchTab(tabName)
    end)
end

-- –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫
function switchTab(tabName)
    currentTab = tabName
    
    for name, frame in pairs(tabFrames) do
        frame.Visible = false
    end
    
    for name, button in pairs(tabButtons) do
        button.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    end
    
    if tabFrames[tabName] then
        tabFrames[tabName].Visible = true
    end
    if tabButtons[tabName] then
        tabButtons[tabName].BackgroundColor3 = tabs[tabName].color
    end
end

-- –°–û–î–ï–†–ñ–ò–ú–û–ï –í–ö–õ–ê–î–û–ö

-- –í–∫–ª–∞–¥–∫–∞ Movement
local MovementContent = tabFrames.Movement

local FlyToggle = createMinecraftToggle(MovementContent, "Flight", UDim2.new(0.05, 0, 0.05, 0), settings.isFlying, function(value)
    settings.isFlying = value
    if value then
        enableFlight()
    else
        disableFlight()
    end
end)

local NoClipToggle = createMinecraftToggle(MovementContent, "NoClip", UDim2.new(0.05, 0, 0.12, 0), settings.isNoClip, function(value)
    settings.isNoClip = value
    if value then
        enableNoClip()
    else
        disableNoClip()
    end
end)

local SpeedToggle = createMinecraftToggle(MovementContent, "Speed Hack", UDim2.new(0.05, 0, 0.19, 0), settings.isSpeedHack, function(value)
    settings.isSpeedHack = value
    if value then
        enableSpeedHack()
    else
        disableSpeedHack()
    end
end)

local BhopToggle = createMinecraftToggle(MovementContent, "Bunny Hop", UDim2.new(0.05, 0, 0.26, 0), settings.isBhop, function(value)
    settings.isBhop = value
    if value then
        enableBhop()
    else
        disableBhop()
    end
end)

createMinecraftSlider(MovementContent, "Flight Speed", UDim2.new(0.05, 0, 0.35, 0), 1, 10, settings.speed, function(value)
    settings.speed = value
end)

createMinecraftSlider(MovementContent, "Speed Multiplier", UDim2.new(0.05, 0, 0.45, 0), 1, 5, settings.speedHackValue, function(value)
    settings.speedHackValue = value
    if settings.isSpeedHack then
        disableSpeedHack()
        enableSpeedHack()
    end
end)

createMinecraftSlider(MovementContent, "Bhop Speed", UDim2.new(0.05, 0, 0.55, 0), 1, 3, settings.bhopSpeed, function(value)
    settings.bhopSpeed = value
end)

-- –í–∫–ª–∞–¥–∫–∞ Visuals
local VisualsContent = tabFrames.Visuals

local ESPToggle = createMinecraftToggle(VisualsContent, "Player ESP", UDim2.new(0.05, 0, 0.05, 0), settings.isESPEnabled, function(value)
    settings.isESPEnabled = value
    if value then
        enableESP()
    else
        disableESP()
    end
end)

local ESPNamesToggle = createMinecraftToggle(VisualsContent, "Show Names", UDim2.new(0.05, 0, 0.12, 0), settings.espNames, function(value)
    settings.espNames = value
    updateESP()
end)

local ESPDistanceToggle = createMinecraftToggle(VisualsContent, "Show Distance", UDim2.new(0.05, 0, 0.19, 0), settings.espDistance, function(value)
    settings.espDistance = value
    updateESP()
end)

local ESPBoxesToggle = createMinecraftToggle(VisualsContent, "Show Boxes", UDim2.new(0.05, 0, 0.26, 0), settings.espBoxes, function(value)
    settings.espBoxes = value
    updateESP()
end)

local FullbrightToggle = createMinecraftToggle(VisualsContent, "Fullbright", UDim2.new(0.05, 0, 0.35, 0), settings.isFullbright, function(value)
    settings.isFullbright = value
    if value then
        enableFullbright()
    else
        disableFullbright()
    end
end)

-- –í–∫–ª–∞–¥–∫–∞ Combat
local CombatContent = tabFrames.Combat

local AimbotToggle = createMinecraftToggle(CombatContent, "Aimbot", UDim2.new(0.05, 0, 0.05, 0), settings.isAimbot, function(value)
    settings.isAimbot = value
    if value then
        enableAimbot()
    else
        disableAimbot()
    end
end)

createMinecraftLabel(CombatContent, "Aimbot Settings", UDim2.new(0.05, 0, 0.15, 0), UDim2.new(0.9, 0, 0, 20))
createMinecraftLabel(CombatContent, "Hold "..settings.keybinds.aimbot.Name.." to aim", UDim2.new(0.05, 0, 0.2, 0), UDim2.new(0.9, 0, 0, 20))

-- –í–∫–ª–∞–¥–∫–∞ Utility
local UtilityContent = tabFrames.Utility

local AntiAFKToggle = createMinecraftToggle(UtilityContent, "Anti-AFK", UDim2.new(0.05, 0, 0.05, 0), settings.isAntiAFK, function(value)
    settings.isAntiAFK = value
    if value then
        enableAntiAFK()
    else
        disableAntiAFK()
    end
end)

-- –í–∫–ª–∞–¥–∫–∞ Keybinds
local KeybindsContent = tabFrames.Keybinds

createMinecraftLabel(KeybindsContent, "Click to change keybinds", UDim2.new(0.05, 0, 0.02, 0), UDim2.new(0.9, 0, 0, 20))

local FlyBind = createBindButton(KeybindsContent, "Flight", settings.keybinds.fly, UDim2.new(0.05, 0, 0.1, 0), function(newKey)
    settings.keybinds.fly = newKey
end)

local NoClipBind = createBindButton(KeybindsContent, "NoClip", settings.keybinds.noclip, UDim2.new(0.05, 0, 0.2, 0), function(newKey)
    settings.keybinds.noclip = newKey
end)

local ESPBind = createBindButton(KeybindsContent, "ESP", settings.keybinds.esp, UDim2.new(0.05, 0, 0.3, 0), function(newKey)
    settings.keybinds.esp = newKey
end)

local AimbotBind = createBindButton(KeybindsContent, "Aimbot", settings.keybinds.aimbot, UDim2.new(0.05, 0, 0.4, 0), function(newKey)
    settings.keybinds.aimbot = newKey
end)

local BhopBind = createBindButton(KeybindsContent, "Bunny Hop", settings.keybinds.bhop, UDim2.new(0.05, 0, 0.5, 0), function(newKey)
    settings.keybinds.bhop = newKey
end)

local SpeedBind = createBindButton(KeybindsContent, "Speed Hack", settings.keybinds.speedhack, UDim2.new(0.05, 0, 0.6, 0), function(newKey)
    settings.keybinds.speedhack = newKey
end)

-- –í–∫–ª–∞–¥–∫–∞ Settings
local SettingsContent = tabFrames.Settings

createMinecraftLabel(SettingsContent, "GUI Key: Insert", UDim2.new(0.05, 0, 0.05, 0), UDim2.new(0.9, 0, 0, 20))
createMinecraftLabel(SettingsContent, "Panic Key: Delete", UDim2.new(0.05, 0, 0.1, 0), UDim2.new(0.9, 0, 0, 20))
createMinecraftLabel(SettingsContent, "Unload Key: End", UDim2.new(0.05, 0, 0.15, 0), UDim2.new(0.9, 0, 0, 20))

local ResetButton = createMinecraftButton(SettingsContent, "Reset All Settings", UDim2.new(0.05, 0, 0.25, 0), UDim2.new(0.9, 0, 0, 35), Color3.fromRGB(200, 100, 100))

createMinecraftLabel(SettingsContent, "Advanced Cheats V6", UDim2.new(0.05, 0, 0.8, 0), UDim2.new(0.9, 0, 0, 20))
createMinecraftLabel(SettingsContent, "By XNEO", UDim2.new(0.05, 0, 0.85, 0), UDim2.new(0.9, 0, 0, 20))

-- –°–ò–°–¢–ï–ú–´ –§–£–ù–ö–¶–ò–ô

-- Flight System (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
function enableFlight()
    if settings.isFlying then return end
    settings.isFlying = true
    -- Flight implementation...
end

function disableFlight()
    if not settings.isFlying then return end
    settings.isFlying = false
    -- Flight cleanup...
end

-- NoClip System
function enableNoClip()
    if settings.isNoClip then return end
    settings.isNoClip = true
    -- NoClip implementation...
end

function disableNoClip()
    if not settings.isNoClip then return end
    settings.isNoClip = false
    -- NoClip cleanup...
end

-- Speed Hack System
function enableSpeedHack()
    if settings.isSpeedHack then return end
    settings.isSpeedHack = true
    
    local character = player.Character
    if not character then return end
    
    local humanoid = character:FindFirstChildWhichIsA("Humanoid")
    if humanoid then
        humanoid.WalkSpeed = humanoid.WalkSpeed * settings.speedHackValue
    end
end

function disableSpeedHack()
    if not settings.isSpeedHack then return end
    settings.isSpeedHack = false
    
    local character = player.Character
    if not character then return end
    
    local humanoid = character:FindFirstChildWhichIsA("Humanoid")
    if humanoid then
        humanoid.WalkSpeed = humanoid.WalkSpeed / settings.speedHackValue
    end
end

-- Bunny Hop System
function enableBhop()
    if settings.isBhop then return end
    settings.isBhop = true
    
    bhopConnection = RunService.Heartbeat:Connect(function()
        if not settings.isBhop or not player.Character then return end
        
        local humanoid = player.Character:FindFirstChildWhichIsA("Humanoid")
        if humanoid and humanoid.FloorMaterial ~= Enum.Material.Air then
            humanoid.Jump = true
        end
    end)
end

function disableBhop()
    if not settings.isBhop then return end
    settings.isBhop = false
    
    if bhopConnection then
        bhopConnection:Disconnect()
    end
end

-- ESP System
function enableESP()
    if settings.isESPEnabled then return end
    settings.isESPEnabled = true
    
    for _, otherPlayer in pairs(Players:GetPlayers()) do
        if otherPlayer ~= player then
            createESP(otherPlayer)
        end
    end
end

function disableESP()
    if not settings.isESPEnabled then return end
    settings.isESPEnabled = false
    
    for _, espData in pairs(espHighlights) do
        if espData then
            if espData.highlight then espData.highlight:Destroy() end
            if espData.billboard then espData.billboard:Destroy() end
            if espData.connection then espData.connection:Disconnect() end
        end
    end
    espHighlights = {}
end

function updateESP()
    for player, espData in pairs(espHighlights) do
        if espData and espData.billboard then
            local nameLabel = espData.billboard:FindFirstChild("NameLabel")
            local distanceLabel = espData.billboard:FindFirstChild("DistanceLabel")
            
            if nameLabel then
                nameLabel.Visible = settings.espNames
            end
            if distanceLabel then
                distanceLabel.Visible = settings.espDistance
            end
            if espData.highlight then
                espData.highlight.Enabled = settings.espBoxes
            end
        end
    end
end

function createESP(targetPlayer)
    -- ESP implementation with name tags and distance...
end

-- Aimbot System
function enableAimbot()
    if settings.isAimbot then return end
    settings.isAimbot = true
    -- Aimbot implementation...
end

function disableAimbot()
    if not settings.isAimbot then return end
    settings.isAimbot = false
    -- Aimbot cleanup...
end

-- Anti-AFK System
function enableAntiAFK()
    if settings.isAntiAFK then return end
    settings.isAntiAFK = true
    
    antiAFKConnection = RunService.Heartbeat:Connect(function()
        if not settings.isAntiAFK then return end
        local virtualUser = game:GetService("VirtualUser")
        virtualUser:CaptureController()
        virtualUser:ClickButton2(Vector2.new())
    end)
end

function disableAntiAFK()
    if not settings.isAntiAFK then return end
    settings.isAntiAFK = false
    
    if antiAFKConnection then
        antiAFKConnection:Disconnect()
    end
end

-- Fullbright System
function enableFullbright()
    if settings.isFullbright then return end
    settings.isFullbright = true
    
    Lighting.Ambient = Color3.new(1, 1, 1)
    Lighting.Brightness = 2
    Lighting.GlobalShadows = false
end

function disableFullbright()
    if not settings.isFullbright then return end
    settings.isFullbright = false
    
    Lighting.Ambient = Color3.new(0, 0, 0)
    Lighting.Brightness = 1
    Lighting.GlobalShadows = true
end

-- Keybind System
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    -- GUI Controls
    if input.KeyCode == Enum.KeyCode.Insert then
        MainFrame.Visible = not MainFrame.Visible
    elseif input.KeyCode == Enum.KeyCode.Delete then
        -- Panic button
        disableFlight()
        disableNoClip()
        disableSpeedHack()
        disableBhop()
        disableESP()
        disableAimbot()
        disableAntiAFK()
        disableFullbright()
    elseif input.KeyCode == Enum.KeyCode.End then
        -- Unload
        disableFlight()
        disableNoClip()
        disableSpeedHack()
        disableBhop()
        disableESP()
        disableAimbot()
        disableAntiAFK()
        disableFullbright()
        main:Destroy()
        return
    end
    
    -- Custom Keybinds
    if input.KeyCode == settings.keybinds.fly then
        settings.isFlying = not settings.isFlying
        if settings.isFlying then
            enableFlight()
        else
            disableFlight()
        end
    elseif input.KeyCode == settings.keybinds.noclip then
        settings.isNoClip = not settings.isNoClip
        if settings.isNoClip then
            enableNoClip()
        else
            disableNoClip()
        end
    elseif input.KeyCode == settings.keybinds.esp then
        settings.isESPEnabled = not settings.isESPEnabled
        if settings.isESPEnabled then
            enableESP()
        else
            disableESP()
        end
    elseif input.KeyCode == settings.keybinds.aimbot then
        -- Aimbot is hold-to-use
        if settings.isAimbot then
            -- Aimbot logic when key is held
        end
    elseif input.KeyCode == settings.keybinds.bhop then
        settings.isBhop = not settings.isBhop
        if settings.isBhop then
            enableBhop()
        else
            disableBhop()
        end
    elseif input.KeyCode == settings.keybinds.speedhack then
        settings.isSpeedHack = not settings.isSpeedHack
        if settings.isSpeedHack then
            enableSpeedHack()
        else
            disableSpeedHack()
        end
    end
end)

-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
ResetButton.MouseButton1Click:Connect(function()
    -- Reset all to default
    disableFlight()
    disableNoClip()
    disableSpeedHack()
    disableBhop()
    disableESP()
    disableAimbot()
    disableAntiAFK()
    disableFullbright()
    
    settings = {
        speed = 1,
        isFlying = false,
        isNoClip = false,
        isESPEnabled = false,
        isSpeedHack = false,
        isAimbot = false,
        isBhop = false,
        isAntiAFK = false,
        isFullbright = false,
        espNames = true,
        espDistance = true,
        espBoxes = true,
        speedHackValue = 2,
        bhopSpeed = 1.5,
        keybinds = {
            fly = Enum.KeyCode.F,
            noclip = Enum.KeyCode.V,
            esp = Enum.KeyCode.X,
            aimbot = Enum.KeyCode.Q,
            bhop = Enum.KeyCode.Space,
            speedhack = Enum.KeyCode.LeftShift
        }
    }
    
    switchTab(currentTab)
end)

CloseButton.MouseButton1Click:Connect(function()
    main:Destroy()
end)

MinimizeButton.MouseButton1Click:Connect(function()
    MainFrame.Visible = false
end)

-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞
player.CharacterAdded:Connect(function(character)
    wait(1)
    disableFlight()
    disableNoClip()
    
    local humanoid = character:WaitForChild("Humanoid")
    humanoid.Died:Connect(function()
        disableFlight()
        disableNoClip()
    end)
end)

-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
switchTab("Movement")

-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
game:GetService("StarterGui"):SetCore("SendNotification", {
    Title = "ADVANCED CHEATS V6",
    Text = "Loaded! Check Keybinds tab to customize",
    Duration = 5
})

print("Advanced Cheats V6 loaded!")
print("Features: Flight, NoClip, SpeedHack, Bhop, ESP, Aimbot, Anti-AFK, Fullbright")
print("Customize keybinds in the Keybinds tab!")
